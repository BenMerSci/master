title: "Compare models"
author: "Benjamin Mercier"
date: "`r paste('Last updated on', format(Sys.time(), '%d %B, %Y'))`"
---

<!-- Load nedeed libraries -->
```{r, echo = FALSE, message=FALSE, warning=FALSE}
suppressPackageStartupMessages(library(rstan))
suppressPackageStartupMessages(library(loo))
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(tidybayes))
suppressPackageStartupMessages(library(bayesplot))
suppressPackageStartupMessages(library(knitr))
suppressPackageStartupMessages(library(ggdist))
suppressPackageStartupMessages(library(ggridges))
suppressPackageStartupMessages(library(hrbrthemes))
suppressPackageStartupMessages(library(viridis))
```
<!-- Load the data --> 
```{r load_model1, echo = FALSE, include = FALSE}
output_stan_model0 <- readRDS("results/model_outputs/output_stan_model0.RDS")
output_stan_model1 <- readRDS("results/model_outputs/output_stan_model1.RDS")
output_stan_model2 <- readRDS("results/model_outputs/output_stan_model2.RDS")
output_stan_model3 <- readRDS("results/model_outputs/output_stan_model3.RDS")
output_stan_model4 <- readRDS("results/model_outputs/output_stan_model4.RDS")

```

```{r compute_loo, echo=FALSE}
log_lik_0 <- extract_log_lik(output_stan_model0, merge_chains = FALSE)
r_eff_0 <- relative_eff(exp(log_lik_0), cores = 8) 
loo_0 <- loo(log_lik_0, r_eff = r_eff_0, cores = 8)

log_lik_1 <- extract_log_lik(output_stan_model1, merge_chains = FALSE)
r_eff_1 <- relative_eff(exp(log_lik_1), cores = 8) 
loo_1 <- loo(log_lik_1, r_eff = r_eff_1, cores = 8)

log_lik_2 <- extract_log_lik(output_stan_model2, merge_chains = FALSE)
r_eff_2 <- relative_eff(exp(log_lik_2), cores = 8) 
loo_2 <- loo(log_lik_2, r_eff = r_eff_2, cores = 8)

log_lik_3 <- extract_log_lik(output_stan_model3, merge_chains = FALSE)
r_eff_3 <- relative_eff(exp(log_lik_3), cores = 8) 
loo_3 <- loo(log_lik_3, r_eff = r_eff_3, cores = 8)

log_lik_4 <- extract_log_lik(output_stan_model4, merge_chains = FALSE)
r_eff_4 <- relative_eff(exp(log_lik_4), cores = 8) 
loo_4 <- loo(log_lik_4, r_eff = r_eff_4, cores = 8)
```

```{r compare_loo, echo=FALSE}
loo_compare(list(model_0=loo_0, model_1=loo_1, model_2=loo_2, model_3=loo_3, model_4=loo_4))
```